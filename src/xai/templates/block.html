{% extends "base.html" %}

{% block title %}XAI Block Explorer - Block #{{ block.index if block else 'N/A' }}{% endblock %}

{% block content %}
{% if block %}
<div class="card">
    <h2>Block #{{ block.index }}</h2>
    <table>
        <tr>
            <td><strong>Block Height</strong></td>
            <td>{{ block.index }}</td>
        </tr>
        <tr>
            <td><strong>Block Hash</strong></td>
            <td class="hash">{{ block.hash }}</td>
        </tr>
        <tr>
            <td><strong>Previous Hash</strong></td>
            <td class="hash">{{ block.previous_hash }}</td>
        </tr>
        <tr>
            <td><strong>Merkle Root</strong></td>
            <td class="hash">{{ block.merkle_root }}</td>
        </tr>
        <tr>
            <td><strong>Timestamp</strong></td>
            <td>{{ format_timestamp(block.timestamp) }}</td>
        </tr>
        <tr>
            <td><strong>Difficulty</strong></td>
            <td>{{ block.difficulty }}</td>
        </tr>
        <tr>
            <td><strong>Nonce</strong></td>
            <td>{{ block.nonce }}</td>
        </tr>
        <tr>
            <td><strong>Number of Transactions</strong></td>
            <td>{{ block.transactions|length }}</td>
        </tr>
    </table>
</div>

<div class="card">
    <h2>Transactions ({{ block.transactions|length }})</h2>
    {% if block.transactions %}
    <table>
        <thead>
            <tr>
                <th>Transaction ID</th>
                <th>From</th>
                <th>To</th>
                <th>Amount</th>
                <th>Fee</th>
                <th>Type</th>
            </tr>
        </thead>
        <tbody>
            {% for tx in block.transactions %}
            <tr>
                <td class="hash truncate">
                    <a href="/transaction/{{ tx.txid }}" title="{{ tx.txid }}">{{ tx.txid[:16] }}...</a>
                </td>
                <td class="hash truncate">
                    {% if tx.sender == 'COINBASE' %}
                        <span style="color: #4ecdc4;">COINBASE</span>
                    {% else %}
                        <a href="/address/{{ tx.sender }}" title="{{ tx.sender }}">{{ tx.sender[:16] }}...</a>
                    {% endif %}
                </td>
                <td class="hash truncate">
                    <a href="/address/{{ tx.recipient }}" title="{{ tx.recipient }}">{{ tx.recipient[:16] }}...</a>
                </td>
                <td>{{ format_amount(tx.amount) }} XAI</td>
                <td>{{ format_amount(tx.fee) }} XAI</td>
                <td>
                    {% if tx.tx_type %}
                        <span style="color: #ff6b6b;">{{ tx.tx_type }}</span>
                    {% else %}
                        normal
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p>No transactions in this block.</p>
    {% endif %}
</div>

<div style="margin-top: 20px;">
    {% if block.index > 0 %}
    <a href="/block/{{ block.index - 1 }}">← Previous Block</a>
    {% endif %}
    <a href="/block/{{ block.index + 1 }}" style="float: right;">Next Block →</a>
</div>
{% else %}
<div class="card">
    <h2>Block Not Found</h2>
    <p>The requested block does not exist or the node is unavailable.</p>
</div>
{% endif %}
{% endblock %}
